<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en">
<head>
<meta http-equiv="Content-Type" content="text/html; charset=UTF-8">
<meta charset="utf-8">
<meta http-equiv="X-UA-Compatible" content="IE=edge">
<meta name="viewport" content="width=device-width, initial-scale=1.0">
<title>Creating Data Packages in R • datapackage.r</title>
<!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.3.1/jquery.min.js" integrity="sha256-FgpCb/KJQlLNfOu91ta32o/NMZxltwRo8QtmkMRdAu8=" crossorigin="anonymous"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/css/bootstrap.min.css" integrity="sha256-916EbMg70RQy9LHiGkXzG8hSg9EdNy97GazNG/aiY1w=" crossorigin="anonymous">
<script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.3.7/js/bootstrap.min.js" integrity="sha256-U5ZEeKfGNOja007MMD3YBI0A3OSZOQbeG6z2f2Y0hu8=" crossorigin="anonymous"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/all.min.css" integrity="sha256-nAmazAk6vS34Xqo0BSrTb+abbtFlgsFK7NKSi6o7Y78=" crossorigin="anonymous">
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.7.1/css/v4-shims.min.css" integrity="sha256-6qHlizsOWFskGlwVOKuns+D1nB6ssZrHQrNj1wGplHc=" crossorigin="anonymous">
<!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.4/clipboard.min.js" integrity="sha256-FiZwavyI2V6+EXO1U+xzLG3IKldpiTFf3153ea9zikQ=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/headroom.min.js" integrity="sha256-DJFC1kqIhelURkuza0AvYal5RxMtpzLjFhsnVIeuk+U=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.9.4/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet">
<script src="../pkgdown.js"></script><meta property="og:title" content="Creating Data Packages in R">
<meta property="og:description" content="">
<meta name="twitter:card" content="summary">
<!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]-->
</head>
<body>
    <div class="container template-article">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">datapackage.r</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="Released version">1.3.0</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav">
<li>
  <a href="../index.html">
    <span class="fas fa fas fa-home fa-lg"></span>
     
  </a>
</li>
<li>
  <a href="../reference/index.html">Reference</a>
</li>
<li class="dropdown">
  <a href="#" class="dropdown-toggle" data-toggle="dropdown" role="button" aria-expanded="false">
    Articles
     
    <span class="caret"></span>
  </a>
  <ul class="dropdown-menu" role="menu">
<li>
      <a href="../articles/creating_data_packages_in_r.html">Creating Data Packages in R</a>
    </li>
    <li>
      <a href="../articles/using_data_packages_in_r.Rmd.html">Using Data Packages in R</a>
    </li>
  </ul>
</li>
<li>
  <a href="../news/index.html">Changelog</a>
</li>
      </ul>
<ul class="nav navbar-nav navbar-right">
<li>
  <a href="https://github.com/frictionlessdata/datapackage-r">
    <span class="fab fa fab fa-github fa-lg"></span>
     
  </a>
</li>
      </ul>
</div>
<!--/.nav-collapse -->
  </div>
<!--/.container -->
</div>
<!--/.navbar -->

      

      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header toc-ignore">
      <h1>Creating Data Packages in R</h1>
                        <h4 class="author">Kleanthis Koupidis</h4>
            
            <h4 class="date">2020-03-12</h4>
      
      <small class="dont-index">Source: <a href="https://github.com/frictionlessdata/datapackage-r/blob/master/vignettes/creating_data_packages_in_r.Rmd"><code>vignettes/creating_data_packages_in_r.Rmd</code></a></small>
      <div class="hidden name"><code>creating_data_packages_in_r.Rmd</code></div>

    </div>

    
    
<p>This tutorial will show you how to install the R package for working with Data Packages and Table Schema, load a CSV file, infer its schema, and write a Tabular Data Package.</p>
<div id="setup" class="section level1">
<h1 class="hasAnchor">
<a href="#setup" class="anchor"></a>Setup</h1>
<p>For this tutorial, we will need the Data Package R package (<a href="https://github.com/frictionlessdata/datapackage-r">datapackage.r</a>).</p>
<p><a href="https://cran.r-project.org/package=devtools">devtools package</a> is required to install the datapackage.r package from github.</p>
<div class="sourceCode" id="cb1"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb1-1" title="1"><span class="co"># Install devtools package if not already</span></a>
<a class="sourceLine" id="cb1-2" title="2"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"devtools"</span>)</a></code></pre></div>
<p>And then install the development version of <a href="https://github.com/frictionlessdata/datapackage-r">datapackage.r</a> from github.</p>
<div class="sourceCode" id="cb2"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb2-1" title="1"><span class="kw"><a href="https://rdrr.io/r/utils/install.packages.html">install.packages</a></span>(<span class="st">"datapackage.r"</span>)</a>
<a class="sourceLine" id="cb2-2" title="2"><span class="co"># or install the development package</span></a>
<a class="sourceLine" id="cb2-3" title="3">devtools<span class="op">::</span><span class="kw"><a href="https://devtools.r-lib.org//reference/remote-reexports.html">install_github</a></span>(<span class="st">"frictionlessdata/datapackage.r"</span>)</a></code></pre></div>
</div>
<div id="load" class="section level1">
<h1 class="hasAnchor">
<a href="#load" class="anchor"></a>Load</h1>
<p>You can start using the package by loading <code>datapackage.r</code>.</p>
<div class="sourceCode" id="cb3"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb3-1" title="1"><span class="kw"><a href="https://rdrr.io/r/base/library.html">library</a></span>(datapackage.r)</a></code></pre></div>
<p>You can add useful metadata by adding keys to metadata dict attribute. Below, we are adding the required <code>name</code> key as well as a human-readable <code>title</code> key. For the keys supported, please consult the full <a href="https://frictionlessdata.io/specs/data-package/#metadata">Data Package spec</a>. Note, we will be creating the required <code>resources</code> key further down below.</p>
<div class="sourceCode" id="cb4"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb4-1" title="1">dataPackage &lt;-<span class="st"> </span><span class="kw"><a href="../reference/Package.load.html">Package.load</a></span>()</a>
<a class="sourceLine" id="cb4-2" title="2">dataPackage<span class="op">$</span>descriptor[<span class="st">'name'</span>] &lt;-<span class="st"> 'period-table'</span></a>
<a class="sourceLine" id="cb4-3" title="3">dataPackage<span class="op">$</span>descriptor[<span class="st">'title'</span>] &lt;-<span class="st"> 'Periodic Table'</span></a>
<a class="sourceLine" id="cb4-4" title="4"><span class="co"># commit the changes to Package class</span></a>
<a class="sourceLine" id="cb4-5" title="5">dataPackage<span class="op">$</span><span class="kw">commit</span>()</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
</div>
<div id="infer-a-csv-schema" class="section level1">
<h1 class="hasAnchor">
<a href="#infer-a-csv-schema" class="anchor"></a>Infer a CSV Schema</h1>
<p>We will use periodic-table data from remote path: <a href="https://raw.githubusercontent.com/frictionlessdata/datapackage-r/master/vignettes/exampledata/data.csv" class="uri">https://raw.githubusercontent.com/frictionlessdata/datapackage-r/master/vignettes/exampledata/data.csv</a></p>
<table class="table">
<thead><tr class="header">
<th align="center">atomic.number</th>
<th align="center">symbol</th>
<th align="center">name</th>
<th align="center">atomic.mass</th>
<th align="center">metal.or.nonmetal.</th>
</tr></thead>
<tbody>
<tr class="odd">
<td align="center">1</td>
<td align="center">H</td>
<td align="center">Hydrogen</td>
<td align="center">1.00794</td>
<td align="center">nonmetal</td>
</tr>
<tr class="even">
<td align="center">2</td>
<td align="center">He</td>
<td align="center">Helium</td>
<td align="center">4.002602</td>
<td align="center">noble gas</td>
</tr>
<tr class="odd">
<td align="center">3</td>
<td align="center">Li</td>
<td align="center">Lithium</td>
<td align="center">6.941</td>
<td align="center">alkali metal</td>
</tr>
<tr class="even">
<td align="center">4</td>
<td align="center">Be</td>
<td align="center">Beryllium</td>
<td align="center">9.012182</td>
<td align="center">alkaline earth metal</td>
</tr>
<tr class="odd">
<td align="center">5</td>
<td align="center">B</td>
<td align="center">Boron</td>
<td align="center">10.811</td>
<td align="center">metalloid</td>
</tr>
<tr class="even">
<td align="center">6</td>
<td align="center">C</td>
<td align="center">Carbon</td>
<td align="center">12.0107</td>
<td align="center">nonmetal</td>
</tr>
<tr class="odd">
<td align="center">7</td>
<td align="center">N</td>
<td align="center">Nitrogen</td>
<td align="center">14.0067</td>
<td align="center">nonmetal</td>
</tr>
<tr class="even">
<td align="center">8</td>
<td align="center">O</td>
<td align="center">Oxygen</td>
<td align="center">15.9994</td>
<td align="center">nonmetal</td>
</tr>
<tr class="odd">
<td align="center">9</td>
<td align="center">F</td>
<td align="center">Fluorine</td>
<td align="center">18.9984032</td>
<td align="center">halogen</td>
</tr>
<tr class="even">
<td align="center">10</td>
<td align="center">Ne</td>
<td align="center">Neon</td>
<td align="center">20.1797</td>
<td align="center">noble gas</td>
</tr>
</tbody>
</table>
<p>We can guess at our CSV’s <a href="https://frictionlessdata.io/guides/table-schema/">schema</a> by using <code>infer</code> from the Table Schema package. We pass directly the remote link to the infer function, the result of which is an inferred schema. For example, if the processor detects only integers in a given column, it will assign <code>integer</code> as a column type.</p>
<div class="sourceCode" id="cb6"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb6-1" title="1">filepath &lt;-<span class="st"> 'https://raw.githubusercontent.com/frictionlessdata/datapackage-r/master/vignettes/exampledata/data.csv'</span></a>
<a class="sourceLine" id="cb6-2" title="2"></a>
<a class="sourceLine" id="cb6-3" title="3">schema &lt;-<span class="st"> </span>tableschema.r<span class="op">::</span><span class="kw">infer</span>(filepath)</a></code></pre></div>
<p>Once we have a schema, we are now ready to add a <code>resource</code> key to the Data Package which points to the resource path and its newly created schema. Below we define resources with three ways, using json text format with usual assignment operator in R list objects and directly using <code>addResource</code> function of <code>Package</code> class:</p>
<div class="sourceCode" id="cb7"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb7-1" title="1"><span class="co"># define resources using json text </span></a>
<a class="sourceLine" id="cb7-2" title="2">resources &lt;-<span class="st"> </span><span class="kw"><a href="../reference/helpers.from.json.to.list.html">helpers.from.json.to.list</a></span>(</a>
<a class="sourceLine" id="cb7-3" title="3">  <span class="st">'[{</span></a>
<a class="sourceLine" id="cb7-4" title="4"><span class="st">    "name": "data",</span></a>
<a class="sourceLine" id="cb7-5" title="5"><span class="st">    "path": "filepath",</span></a>
<a class="sourceLine" id="cb7-6" title="6"><span class="st">    "schema": "schema"</span></a>
<a class="sourceLine" id="cb7-7" title="7"><span class="st">  }]'</span></a>
<a class="sourceLine" id="cb7-8" title="8">)</a>
<a class="sourceLine" id="cb7-9" title="9">resources[[<span class="dv">1</span>]]<span class="op">$</span>schema &lt;-<span class="st"> </span>schema</a>
<a class="sourceLine" id="cb7-10" title="10">resources[[<span class="dv">1</span>]]<span class="op">$</span>path &lt;-<span class="st"> </span>filepath</a></code></pre></div>
<div class="sourceCode" id="cb8"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb8-1" title="1"><span class="co"># or define resources using list object</span></a>
<a class="sourceLine" id="cb8-2" title="2">resources &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</a>
<a class="sourceLine" id="cb8-3" title="3">  <span class="dt">name =</span> <span class="st">"data"</span>,</a>
<a class="sourceLine" id="cb8-4" title="4">  <span class="dt">path =</span> filepath,</a>
<a class="sourceLine" id="cb8-5" title="5">  <span class="dt">schema =</span> schema</a>
<a class="sourceLine" id="cb8-6" title="6">  ))</a></code></pre></div>
<p>And now, add resources to the Data Package:</p>
<div class="sourceCode" id="cb9"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb9-1" title="1">dataPackage<span class="op">$</span>descriptor[[<span class="st">'resources'</span>]] &lt;-<span class="st"> </span>resources</a>
<a class="sourceLine" id="cb9-2" title="2">dataPackage<span class="op">$</span><span class="kw">commit</span>()</a></code></pre></div>
<pre><code>## [1] TRUE</code></pre>
<p>Or you can directly add resources using <code>addResources</code> function of <code>Package</code> class:</p>
<div class="sourceCode" id="cb11"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb11-1" title="1">resources &lt;-<span class="st"> </span><span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(<span class="kw"><a href="https://rdrr.io/r/base/list.html">list</a></span>(</a>
<a class="sourceLine" id="cb11-2" title="2">  <span class="dt">name =</span> <span class="st">"data"</span>,</a>
<a class="sourceLine" id="cb11-3" title="3">  <span class="dt">path =</span> filepath,</a>
<a class="sourceLine" id="cb11-4" title="4">  <span class="dt">schema =</span> schema</a>
<a class="sourceLine" id="cb11-5" title="5">  ))</a>
<a class="sourceLine" id="cb11-6" title="6"></a>
<a class="sourceLine" id="cb11-7" title="7">dataPackage<span class="op">$</span><span class="kw">addResource</span>(resources)</a></code></pre></div>
<p>Now we are ready to write our <code>datapackage.json</code> file to the current working directory.</p>
<div class="sourceCode" id="cb12"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb12-1" title="1">dataPackage<span class="op">$</span><span class="kw"><a href="https://rdrr.io/r/base/save.html">save</a></span>(<span class="st">'exampledata'</span>)</a></code></pre></div>
<p>The <code>datapackage.json</code> (<a href="https://raw.githubusercontent.com/frictionlessdata/datapackage-r/master/vignettes/exampledata/package.json">download</a>) is inlined below. Note that atomic number has been correctly inferred as an <code>integer</code> and atomic mass as a <code>number</code> (float) while every other column is a <code>string</code>.</p>
<div class="sourceCode" id="cb13"><pre class="sourceCode r"><code class="sourceCode r"><a class="sourceLine" id="cb13-1" title="1">jsonlite<span class="op">::</span><span class="kw"><a href="https://jeroen.cran.dev/jsonlite/reference/prettify.html">prettify</a></span>(<span class="kw"><a href="../reference/helpers.from.list.to.json.html">helpers.from.list.to.json</a></span>(dataPackage<span class="op">$</span>descriptor))</a></code></pre></div>
<pre><code>## {
##     "profile": "data-package",
##     "name": "period-table",
##     "title": "Periodic Table",
##     "resources": [
##         {
##             "name": "data",
##             "path": "https://raw.githubusercontent.com/frictionlessdata/datapackage-r/master/vignettes/exampledata/data.csv",
##             "schema": {
##                 "fields": [
##                     {
##                         "name": "atomic number",
##                         "type": "integer",
##                         "format": "default"
##                     },
##                     {
##                         "name": "symbol",
##                         "type": "string",
##                         "format": "default"
##                     },
##                     {
##                         "name": "name",
##                         "type": "string",
##                         "format": "default"
##                     },
##                     {
##                         "name": "atomic mass",
##                         "type": "number",
##                         "format": "default"
##                     },
##                     {
##                         "name": "metal or nonmetal?",
##                         "type": "string",
##                         "format": "default"
##                     }
##                 ],
##                 "missingValues": [
##                     ""
##                 ]
##             },
##             "profile": "data-resource",
##             "encoding": "utf-8"
##         }
##     ]
## }
## </code></pre>
</div>
<div id="publishing" class="section level1">
<h1 class="hasAnchor">
<a href="#publishing" class="anchor"></a>Publishing</h1>
<p>Now that you have created your Data Package, you might want to <a href="https://frictionlessdata.io/guides/publish-online/">publish your data online</a> so that you can share it with others.</p>
</div>
  </div>

  <div class="col-md-3 hidden-xs hidden-sm" id="sidebar">

        <div id="tocnav">
      <h2 class="hasAnchor">
<a href="#tocnav" class="anchor"></a>Contents</h2>
      <ul class="nav nav-pills nav-stacked">
<li><a href="#setup">Setup</a></li>
      <li><a href="#load">Load</a></li>
      <li><a href="#infer-a-csv-schema">Infer a CSV Schema</a></li>
      <li><a href="#publishing">Publishing</a></li>
      </ul>
</div>
      </div>

</div>



      <footer><div class="copyright">
  <p>Developed by Kleanthis Koupidis, Lazaros Ioannidis, Charalampos Bratsas.</p>
</div>

<div class="pkgdown">
  <p>Site built with <a href="https://pkgdown.r-lib.org/">pkgdown</a> 1.4.1.</p>
</div>

      </footer>
</div>

  


  </body>
</html>
